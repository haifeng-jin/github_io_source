---
layout: post
title: poj1093
category: chinese
---
<p>题意：给出一个句子和要求整理后每行包含的字符数，要求将其整理为一种总badness最小的形式。设每个空格长度为n，单个空格的badness计算公式为(n-1)^2。总badness等于所有空格的badness的总和。给出整理后的格式。在badness最小的前提下，在分配一行中的空格时要让前面的空格尽量少。如果一个单词单占一行，badness为500。</p>
<p>分析：动态规划。f[i]表示前i个单词的最小badness是多少。f[i]=f[i-j]+cost(i-j,j);。cost(a,b)表示从单词a+1到单词b的放在一行中最小badness是多少。</p>
<p>并用from[i]存储f[i]是从哪个位置计算得来的值，即最后一次更新f[i]时i-j是几，即f[i]所在行的上一行的最后一个单词是第几个。</p>
<p>我们利用from数组可以求出最佳方案，然后按照题中要求输出即可。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('a4fa06f4-767b-4ec3-a3ac-be2227371976')"><img id="code_img_closed_a4fa06f4-767b-4ec3-a3ac-be2227371976" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_a4fa06f4-767b-4ec3-a3ac-be2227371976" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('a4fa06f4-767b-4ec3-a3ac-be2227371976',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_a4fa06f4-767b-4ec3-a3ac-be2227371976" class="cnblogs_code_hide">
<pre>#include &lt;iostream&gt;<span style="color: #000000;">
#include </span>&lt;cstdio&gt;<span style="color: #000000;">
#include </span>&lt;cstdlib&gt;<span style="color: #000000;">
#include </span>&lt;cstring&gt;
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span><span style="color: #000000;"> std;

</span><span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> maxn = <span style="color: #800080;">1000</span><span style="color: #000000;">;

</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> n, wordsnum;
</span><span style="color: #0000ff;">string</span><span style="color: #000000;"> words[maxn];
</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> sum[maxn];
</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> f[maxn][maxn];
</span><span style="color: #0000ff;">int</span> <span style="color: #0000ff;">from</span><span style="color: #000000;">[maxn][maxn];

</span><span style="color: #0000ff;">void</span> turntowords(<span style="color: #0000ff;">string</span><span style="color: #000000;"> st)
{
    </span><span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span><span style="color: #000000;">;

    </span><span style="color: #0000ff;">while</span> (<span style="color: #800080;">1</span><span style="color: #000000;">)
    {
        i </span>= <span style="color: #800080;">0</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">while</span> (st[i] != <span style="color: #800000;">'</span> <span style="color: #800000;">'</span> &amp;&amp; i &lt;<span style="color: #000000;"> signed(st.length()))
            i</span>++<span style="color: #000000;">;
        words[wordsnum</span>++] = st.substr(<span style="color: #800080;">0</span><span style="color: #000000;">, i);
        sum[wordsnum] </span>= i + sum[wordsnum - <span style="color: #800080;">1</span><span style="color: #000000;">];
        </span><span style="color: #0000ff;">if</span> (i ==<span style="color: #000000;"> signed(st.length()))
            </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
        st.erase(</span><span style="color: #800080;">0</span><span style="color: #000000;">, i);
        </span><span style="color: #0000ff;">while</span> (st[<span style="color: #800080;">0</span>] == <span style="color: #800000;">'</span> <span style="color: #800000;">'</span><span style="color: #000000;">)
            st.erase(</span><span style="color: #800080;">0</span>, <span style="color: #800080;">1</span><span style="color: #000000;">);
    }
}

</span><span style="color: #0000ff;">void</span><span style="color: #000000;"> init()
{
    </span><span style="color: #0000ff;">string</span><span style="color: #000000;"> st;

    wordsnum </span>= <span style="color: #800080;">0</span><span style="color: #000000;">;
    memset(sum, </span><span style="color: #800080;">0</span>, <span style="color: #0000ff;">sizeof</span><span style="color: #000000;">(sum));
    getchar();
    </span><span style="color: #0000ff;">while</span> (<span style="color: #800080;">1</span><span style="color: #000000;">)
    {
        getline(cin, st);
        </span><span style="color: #0000ff;">if</span> (st == <span style="color: #800000;">""</span><span style="color: #000000;">)
            </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
        turntowords(st);
    }
}

</span><span style="color: #0000ff;">int</span> cost(<span style="color: #0000ff;">int</span> start, <span style="color: #0000ff;">int</span><span style="color: #000000;"> end)
{
    </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> left, right, tot, len;

    </span><span style="color: #0000ff;">if</span> (end - start == <span style="color: #800080;">1</span><span style="color: #000000;">)
        </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">500</span><span style="color: #000000;">;
    tot </span>= n - (sum[end] -<span style="color: #000000;"> sum[start]);
    len </span>= tot / (end - start - <span style="color: #800080;">1</span><span style="color: #000000;">);
    left </span>= end - start - <span style="color: #800080;">1</span> - tot % (end - start - <span style="color: #800080;">1</span><span style="color: #000000;">);
    right </span>= tot % (end - start - <span style="color: #800080;">1</span><span style="color: #000000;">);
    </span><span style="color: #0000ff;">return</span> left * (len - <span style="color: #800080;">1</span>) * (len - <span style="color: #800080;">1</span>) + right * len *<span style="color: #000000;"> len;
}

</span><span style="color: #0000ff;">void</span><span style="color: #000000;"> work()
{
    </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i, j, k;

    memset(f, </span>-<span style="color: #800080;">1</span>, <span style="color: #0000ff;">sizeof</span><span style="color: #000000;">(f));
    f[</span><span style="color: #800080;">0</span>][<span style="color: #800080;">0</span>] = <span style="color: #800080;">0</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">for</span> (i = <span style="color: #800080;">1</span>; i &lt;= wordsnum; i++<span style="color: #000000;">)
        </span><span style="color: #0000ff;">for</span> (j = <span style="color: #800080;">1</span>; j &lt;= wordsnum; j++<span style="color: #000000;">)
            </span><span style="color: #0000ff;">for</span> (k = <span style="color: #800080;">1</span>; k &lt;= j &amp;&amp; j - k &gt;= i - <span style="color: #800080;">1</span> &amp;&amp; n - (sum[j] - sum[j - k]) &gt;= k - <span style="color: #800080;">1</span>; k++<span style="color: #000000;">)
                </span><span style="color: #0000ff;">if</span> (f[i - <span style="color: #800080;">1</span>][j - k] != -<span style="color: #800080;">1</span> &amp;&amp; (f[i][j] &gt; f[i - <span style="color: #800080;">1</span>][j - k] + cost(j - k, j) || f[i][j] == -<span style="color: #800080;">1</span><span style="color: #000000;">))
                {
                    f[i][j] </span>= f[i - <span style="color: #800080;">1</span>][j - k] + cost(j -<span style="color: #000000;"> k, j);
                    </span><span style="color: #0000ff;">from</span>[i][j] =<span style="color: #000000;"> k;
                }
}

</span><span style="color: #0000ff;">void</span> printline(<span style="color: #0000ff;">int</span> start, <span style="color: #0000ff;">int</span><span style="color: #000000;"> end)
{
    </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> left, tot, len, i, j;

    </span><span style="color: #0000ff;">if</span> (end - start == <span style="color: #800080;">1</span><span style="color: #000000;">)
    {
        cout </span>&lt;&lt; words[start] &lt;&lt;<span style="color: #000000;"> endl;
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;
    }
    tot </span>= n - (sum[end] -<span style="color: #000000;"> sum[start]);
    len </span>= tot / (end - start - <span style="color: #800080;">1</span><span style="color: #000000;">);
    left </span>= end - start - <span style="color: #800080;">1</span> - tot % (end - start - <span style="color: #800080;">1</span><span style="color: #000000;">);
    </span><span style="color: #0000ff;">for</span> (i = start; i &lt; end - <span style="color: #800080;">1</span>; i++<span style="color: #000000;">)
    {
        cout </span>&lt;&lt;<span style="color: #000000;"> words[i];
        </span><span style="color: #0000ff;">for</span> (j = <span style="color: #800080;">0</span>; j &lt; len; j++<span style="color: #000000;">)
            printf(</span><span style="color: #800000;">"</span> <span style="color: #800000;">"</span><span style="color: #000000;">);
        </span><span style="color: #0000ff;">if</span> (i - start + <span style="color: #800080;">1</span> &gt;<span style="color: #000000;"> left)
            printf(</span><span style="color: #800000;">"</span> <span style="color: #800000;">"</span><span style="color: #000000;">);
    }
    cout </span>&lt;&lt; words[end - <span style="color: #800080;">1</span>] &lt;&lt;<span style="color: #000000;"> endl;
}

</span><span style="color: #0000ff;">void</span><span style="color: #000000;"> output()
{
    </span><span style="color: #0000ff;">int</span> i, best = <span style="color: #800080;">1000000000</span><span style="color: #000000;">, besti;

    </span><span style="color: #0000ff;">for</span> (i = <span style="color: #800080;">0</span>; i &lt;= wordsnum; i++<span style="color: #000000;">)
        </span><span style="color: #0000ff;">if</span> (f[i][wordsnum] &lt; best &amp;&amp; f[i][wordsnum] &gt;= <span style="color: #800080;">0</span><span style="color: #000000;">)
        {
            best </span>=<span style="color: #000000;"> f[i][wordsnum];
            besti </span>=<span style="color: #000000;"> i;
        }
    </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> line[maxn];
    </span><span style="color: #0000ff;">int</span> j =<span style="color: #000000;"> wordsnum;
    </span><span style="color: #0000ff;">for</span> (i = besti; i &gt; <span style="color: #800080;">0</span>; i--<span style="color: #000000;">)
    {
        line[i] </span>= <span style="color: #0000ff;">from</span><span style="color: #000000;">[i][j];
        j </span>-= <span style="color: #0000ff;">from</span><span style="color: #000000;">[i][j];
    }
    j </span>= <span style="color: #800080;">0</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">for</span> (i = <span style="color: #800080;">1</span>; i &lt;= besti; i++<span style="color: #000000;">)
    {
        printline(j, j </span>+<span style="color: #000000;"> line[i]);
        j </span>+=<span style="color: #000000;"> line[i];
    }
    cout </span>&lt;&lt;<span style="color: #000000;"> endl;
}

</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> main()
{
    </span><span style="color: #008000;">//</span><span style="color: #008000;">freopen("D:\\t.txt", "r", stdin);</span>
    <span style="color: #0000ff;">while</span> (cin &gt;&gt; n &amp;&amp; n != <span style="color: #800080;">0</span><span style="color: #000000;">)
    {
        init();
        work();
        output();
    }
    </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">0</span><span style="color: #000000;">;
}</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code </span></div>
<p>&nbsp;</p>
