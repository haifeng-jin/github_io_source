---
layout: post
title: poj2115
category: chinese
---
<p>题意：for(int i = a; i != b; i = (i + c) % (2 ^ k)) 能运行多少次。</p>
<p>分析：多次错的原因是1&lt;&lt;k，k很大会超出int;</p>
<p>扩展欧几里德，是求x * a + y * b = gcd(a, b) 的整数解。</p>
<p>这题我们可以认为是在mod 2 ^k 的条件下，</p>
<p>c * x = b - a; 求 x。</p>
<p>当然我们也可以直接理解为</p>
<p>本题是求 c * x + 2 ^ k * y = b - a;</p>
<p>先求c * x1 + 2 ^ k * y1 = gcd(c, 2 ^ k);</p>
<p>两端同乘(b - a) / gcd(c, 2 ^ k)即可变为原式</p>
<p>整理x的范围，输出即可</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('087c2b47-f378-47c5-baf9-e2dec3ee697e')"><img id="code_img_closed_087c2b47-f378-47c5-baf9-e2dec3ee697e" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_087c2b47-f378-47c5-baf9-e2dec3ee697e" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('087c2b47-f378-47c5-baf9-e2dec3ee697e',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" /><span class="cnblogs_code_collapse">View Code </span>
<div id="cnblogs_code_open_087c2b47-f378-47c5-baf9-e2dec3ee697e" class="cnblogs_code_hide">
<div><span style="color: #000000;">#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">iostream</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br />#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">cstdio</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br />#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">cstdlib</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br />#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">cstring</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br /></span><span style="color: #0000ff;">using</span><span style="color: #0000ff;">namespace</span><span style="color: #000000;"> std;<br /><br /></span><span style="color: #0000ff;">long</span><span style="color: #0000ff;">long</span><span style="color: #000000;"> a, b, c, k;<br /><br /></span><span style="color: #0000ff;">long</span><span style="color: #0000ff;">long</span><span style="color: #000000;"> extgcd(</span><span style="color: #0000ff;">long</span><span style="color: #0000ff;">long</span><span style="color: #000000;"> a, </span><span style="color: #0000ff;">long</span><span style="color: #0000ff;">long</span><span style="color: #000000;"> b, </span><span style="color: #0000ff;">long</span><span style="color: #0000ff;">long</span><span style="color: #000000;">&amp;</span><span style="color: #000000;">x, </span><span style="color: #0000ff;">long</span><span style="color: #0000ff;">long</span><span style="color: #000000;">&amp;</span><span style="color: #000000;">y)<br />{<br />    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (b </span><span style="color: #000000;">==</span><span style="color: #800080;">0</span><span style="color: #000000;">)<br />    {<br />        x </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">;<br />        y </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">;<br />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> a;<br />    }<br />    </span><span style="color: #0000ff;">long</span><span style="color: #0000ff;">long</span><span style="color: #000000;"> d </span><span style="color: #000000;">=</span><span style="color: #000000;"> extgcd(b, a </span><span style="color: #000000;">%</span><span style="color: #000000;"> b, x, y);<br />    </span><span style="color: #0000ff;">long</span><span style="color: #0000ff;">long</span><span style="color: #000000;"> t </span><span style="color: #000000;">=</span><span style="color: #000000;"> x;<br />    x </span><span style="color: #000000;">=</span><span style="color: #000000;"> y;<br />    y </span><span style="color: #000000;">=</span><span style="color: #000000;"> t </span><span style="color: #000000;">-</span><span style="color: #000000;"> a </span><span style="color: #000000;">/</span><span style="color: #000000;"> b </span><span style="color: #000000;">*</span><span style="color: #000000;"> y;<br />    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> d;<br />}<br /><br /></span><span style="color: #0000ff;">int</span><span style="color: #000000;"> main()<br />{<br />    </span><span style="color: #008000;">//</span><span style="color: #008000;">freopen("t.txt", "r", stdin);</span><span style="color: #008000;"><br /></span><span style="color: #0000ff;">while</span><span style="color: #000000;"> (scanf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%lld%lld%lld%lld</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">a, </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">b, </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">c, </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">k), (a </span><span style="color: #000000;">|</span><span style="color: #000000;"> b </span><span style="color: #000000;">|</span><span style="color: #000000;"> c </span><span style="color: #000000;">|</span><span style="color: #000000;"> k) </span><span style="color: #000000;">!=</span><span style="color: #800080;">0</span><span style="color: #000000;">)<br />    {<br />        </span><span style="color: #0000ff;">long</span><span style="color: #0000ff;">long</span><span style="color: #000000;"> x, y;<br />        </span><span style="color: #0000ff;">long</span><span style="color: #0000ff;">long</span><span style="color: #000000;"> t </span><span style="color: #000000;">=</span><span style="color: #000000;"> b </span><span style="color: #000000;">-</span><span style="color: #000000;"> a;<br />        </span><span style="color: #0000ff;">long</span><span style="color: #0000ff;">long</span><span style="color: #000000;"> h </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">;<br />        h </span><span style="color: #000000;">&lt;&lt;=</span><span style="color: #000000;"> k;<br />        </span><span style="color: #0000ff;">long</span><span style="color: #0000ff;">long</span><span style="color: #000000;"> g </span><span style="color: #000000;">=</span><span style="color: #000000;"> extgcd(c, h, x, y);<br />        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (t </span><span style="color: #000000;">%</span><span style="color: #000000;"> g </span><span style="color: #000000;">!=</span><span style="color: #800080;">0</span><span style="color: #000000;">)<br />        {<br />            printf(</span><span style="color: #800000;">"</span><span style="color: #800000;">FOREVER\n</span><span style="color: #800000;">"</span><span style="color: #000000;">);<br />            </span><span style="color: #0000ff;">continue</span><span style="color: #000000;">;<br />        }<br />        x </span><span style="color: #000000;">*=</span><span style="color: #000000;"> t </span><span style="color: #000000;">/</span><span style="color: #000000;"> g;<br />        x </span><span style="color: #000000;">=</span><span style="color: #000000;"> (x </span><span style="color: #000000;">%</span><span style="color: #000000;"> (h </span><span style="color: #000000;">/</span><span style="color: #000000;"> g) </span><span style="color: #000000;">+</span><span style="color: #000000;"> (h </span><span style="color: #000000;">/</span><span style="color: #000000;"> g)) </span><span style="color: #000000;">%</span><span style="color: #000000;"> (h </span><span style="color: #000000;">/</span><span style="color: #000000;"> g);<br />        printf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%lld\n</span><span style="color: #800000;">"</span><span style="color: #000000;">, x);<br />    }<br />    </span><span style="color: #0000ff;">return</span><span style="color: #800080;">0</span><span style="color: #000000;">;<br />}</span></div>
</div>
</div>
