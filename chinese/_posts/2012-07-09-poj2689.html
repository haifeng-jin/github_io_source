---
layout: post
title: poj2689
category: chinese
---
<p>题意：求区间[l,u]内，距离最近的两个素数，和距离最远的两个素数。区间长度最大1000000，l和u都在int范围内。</p>
<p>分析：由于l,u在2^31内，所以先从1到2^16筛素数。这些素数足以用来判断2^31内的所有数字是否为素数，对于每对l,u，用已知的1～2^16内的素数圈定一个可以筛l,u之间的数字的范围，来筛l,u之间的数字。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('2f0070d2-b492-4836-a7e7-f69cef6bb283')"><img id="code_img_closed_2f0070d2-b492-4836-a7e7-f69cef6bb283" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_2f0070d2-b492-4836-a7e7-f69cef6bb283" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('2f0070d2-b492-4836-a7e7-f69cef6bb283',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" /><span class="cnblogs_code_collapse">View Code </span>
<div id="cnblogs_code_open_2f0070d2-b492-4836-a7e7-f69cef6bb283" class="cnblogs_code_hide">
<pre>#include &lt;iostream&gt;<span style="color: #000000;">
#include </span>&lt;cstdio&gt;<span style="color: #000000;">
#include </span>&lt;cstdlib&gt;<span style="color: #000000;">
#include </span>&lt;cstring&gt;<span style="color: #000000;">
#include </span>&lt;cmath&gt;
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span><span style="color: #000000;"> std;

</span><span style="color: #0000ff;">#define</span> maxn 1 &lt;&lt; 17
<span style="color: #0000ff;">#define</span> maxl 1000005

<span style="color: #0000ff;">int</span><span style="color: #000000;"> l, u;
</span><span style="color: #0000ff;">bool</span> <span style="color: #0000ff;">is</span><span style="color: #000000;">[maxn];
</span><span style="color: #0000ff;">long</span> <span style="color: #0000ff;">long</span><span style="color: #000000;"> prm[maxn];
</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> n;
</span><span style="color: #0000ff;">bool</span><span style="color: #000000;"> ans[maxl];
</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> prime[maxl];
</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> num;

</span><span style="color: #0000ff;">int</span> getprm(<span style="color: #0000ff;">int</span><span style="color: #000000;"> n)
{
    </span><span style="color: #0000ff;">int</span> i, j, k = <span style="color: #800080;">0</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">int</span> s, e = (<span style="color: #0000ff;">int</span>) (sqrt(<span style="color: #800080;">0.0</span> + n) + <span style="color: #800080;">1</span><span style="color: #000000;">);
    memset(</span><span style="color: #0000ff;">is</span>, <span style="color: #800080;">1</span>, <span style="color: #0000ff;">sizeof</span>(<span style="color: #0000ff;">is</span><span style="color: #000000;">));
    prm[k</span>++] = <span style="color: #800080;">2</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">is</span>[<span style="color: #800080;">0</span>] = <span style="color: #0000ff;">is</span>[<span style="color: #800080;">1</span>] = <span style="color: #800080;">0</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">for</span> (i = <span style="color: #800080;">3</span>; i &lt; e; i += <span style="color: #800080;">2</span><span style="color: #000000;">)
        </span><span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">is</span><span style="color: #000000;">[i])
        {
            prm[k</span>++] =<span style="color: #000000;"> i;
            </span><span style="color: #0000ff;">for</span> (s = i * <span style="color: #800080;">2</span>, j = i * i; j &lt; n; j +=<span style="color: #000000;"> s)
                </span><span style="color: #0000ff;">is</span>[j] = <span style="color: #800080;">0</span><span style="color: #000000;">;
        }
    </span><span style="color: #0000ff;">for</span> (; i &lt; n; i += <span style="color: #800080;">2</span><span style="color: #000000;">)
        </span><span style="color: #0000ff;">if</span> (<span style="color: #0000ff;">is</span><span style="color: #000000;">[i])
            prm[k</span>++] =<span style="color: #000000;"> i;
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> k;
}

</span><span style="color: #0000ff;">void</span><span style="color: #000000;"> work()
{
    </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt; u - l + <span style="color: #800080;">1</span>; i++<span style="color: #000000;">)
        ans[i] </span>= <span style="color: #0000ff;">true</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">if</span> (l == <span style="color: #800080;">1</span><span style="color: #000000;">)
        ans[</span><span style="color: #800080;">0</span>] = <span style="color: #0000ff;">false</span><span style="color: #000000;">;
    num </span>= <span style="color: #800080;">0</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt; n &amp;&amp; prm[i] * prm[i] &lt;= u; i++<span style="color: #000000;">)
    {
        </span><span style="color: #0000ff;">long</span> <span style="color: #0000ff;">long</span> temp = (l + prm[i] - <span style="color: #800080;">1</span>) / prm[i] *<span style="color: #000000;"> prm[i];
        </span><span style="color: #0000ff;">if</span> (temp ==<span style="color: #000000;"> prm[i])
            temp </span>+=<span style="color: #000000;"> prm[i];
        </span><span style="color: #0000ff;">while</span> (temp &lt;=<span style="color: #000000;"> u)
        {
            ans[temp </span>- l] = <span style="color: #0000ff;">false</span><span style="color: #000000;">;
            temp </span>+=<span style="color: #000000;"> prm[i];
        }
    }
    </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt; u - l + <span style="color: #800080;">1</span>; i++<span style="color: #000000;">)
        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (ans[i])
            prime[num</span>++] = l +<span style="color: #000000;"> i;
    </span><span style="color: #0000ff;">if</span> (num &lt; <span style="color: #800080;">2</span><span style="color: #000000;">)
    {
        printf(</span><span style="color: #800000;">"</span><span style="color: #800000;">There are no adjacent primes.\n</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;
    }
    </span><span style="color: #0000ff;">int</span> ans1 = <span style="color: #800080;">0</span>, ans2 = <span style="color: #800080;">0</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt; num - <span style="color: #800080;">1</span>; i++<span style="color: #000000;">)
    {
        </span><span style="color: #0000ff;">if</span> (prime[ans1 + <span style="color: #800080;">1</span>] - prime[ans1] &gt; prime[i + <span style="color: #800080;">1</span>] -<span style="color: #000000;"> prime[i])
            ans1 </span>=<span style="color: #000000;"> i;
        </span><span style="color: #0000ff;">if</span> (prime[ans2 + <span style="color: #800080;">1</span>] - prime[ans2] &lt; prime[i + <span style="color: #800080;">1</span>] -<span style="color: #000000;"> prime[i])
            ans2 </span>=<span style="color: #000000;"> i;
    }
    printf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%d,%d are closest, %d,%d are most distant.\n</span><span style="color: #800000;">"</span>, prime[ans1], prime[ans1 + <span style="color: #800080;">1</span>], prime[ans2], prime[ans2 + <span style="color: #800080;">1</span><span style="color: #000000;">]);
}

</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> main()
{
    </span><span style="color: #008000;">//</span><span style="color: #008000;">freopen("t.txt", "r", stdin);</span>
    n = getprm(<span style="color: #800080;">1</span> &lt;&lt; <span style="color: #800080;">16</span><span style="color: #000000;">);
    </span><span style="color: #0000ff;">while</span> (~scanf(<span style="color: #800000;">"</span><span style="color: #800000;">%d%d</span><span style="color: #800000;">"</span>, &amp;l, &amp;<span style="color: #000000;">u))
    {
        work();
    }
    </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">0</span><span style="color: #000000;">;
}</span></pre>
</div>
</div>
