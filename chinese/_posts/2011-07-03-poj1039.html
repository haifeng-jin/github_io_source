---
layout: post
title: poj1039
category: chinese
---
<p>题意：几何计算，给出一个管道（一条从左到右的折线，与它向下移动1后的折线构成），问管道最左边发出的光线所能到达的最远位置的横坐标是多少。</p>
<p><img src="http://poj.org/images/1039/pipe.gif" alt="" /></p>
<p>分析：容易知道，要求一个能到达最远的光线，这条光线一定是经过至少两个折线的折点（每个这点可能是上面折线的，也可能是下面折线的），那么我们就每次枚举两个管道折点，求一直线看该直线与管道边缘线段交点。在求的过程中，可以从左到右依次判断是否与各个折点的横断面相交，然后可以得知是否会与管道壁相交。通过直线在横断面对应横坐标的位置的纵坐标高于还是低于横断面。可以判断其与那个管道壁相交，求交点即可。然后在所有交点中找一个横坐标最小的。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('ee495061-6e07-43ac-9057-879f2645a28b')"><img id="code_img_closed_ee495061-6e07-43ac-9057-879f2645a28b" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_ee495061-6e07-43ac-9057-879f2645a28b" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('ee495061-6e07-43ac-9057-879f2645a28b',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" /><span class="cnblogs_code_collapse">View Code </span>
<div id="cnblogs_code_open_ee495061-6e07-43ac-9057-879f2645a28b" class="cnblogs_code_hide">
<div><span style="color: #000000;">#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">iostream</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br />#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">cstdio</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br />#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">cstdlib</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br />#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">cstring</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br />#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">cmath</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br /></span><span style="color: #0000ff;">using</span><span style="color: #0000ff;">namespace</span><span style="color: #000000;"> std;<br /><br /></span><span style="color: #0000ff;">#define</span><span style="color: #000000;"> maxn 25</span><span style="color: #000000;"><br /></span><span style="color: #0000ff;">#define</span><span style="color: #000000;"> eps 1.0e-8</span><span style="color: #000000;"><br /><br /></span><span style="color: #0000ff;">struct</span><span style="color: #000000;"> Point<br />{<br />    </span><span style="color: #0000ff;">double</span><span style="color: #000000;"> x, y;<br />} point[maxn];<br /><br /></span><span style="color: #0000ff;">int</span><span style="color: #000000;"> n;<br /></span><span style="color: #0000ff;">double</span><span style="color: #000000;"> ans;<br /></span><span style="color: #0000ff;">bool</span><span style="color: #000000;"> ok;<br /><br /></span><span style="color: #0000ff;">void</span><span style="color: #000000;"> input()<br />{<br />    </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">; i </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> n; i</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />        scanf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%lf%lf</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">point[i].x, </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">point[i].y);<br />}<br /><br /></span><span style="color: #0000ff;">double</span><span style="color: #000000;"> intersect(Point a1, Point b1, Point a2, Point b2)<br />{<br />    </span><span style="color: #0000ff;">double</span><span style="color: #000000;"> x1 </span><span style="color: #000000;">=</span><span style="color: #000000;"> a1.x, x2 </span><span style="color: #000000;">=</span><span style="color: #000000;"> b1.x, x3 </span><span style="color: #000000;">=</span><span style="color: #000000;"> a2.x, x4 </span><span style="color: #000000;">=</span><span style="color: #000000;"> b2.x;<br />    </span><span style="color: #0000ff;">double</span><span style="color: #000000;"> y1 </span><span style="color: #000000;">=</span><span style="color: #000000;"> a1.y, y2 </span><span style="color: #000000;">=</span><span style="color: #000000;"> b1.y, y3 </span><span style="color: #000000;">=</span><span style="color: #000000;"> a2.y, y4 </span><span style="color: #000000;">=</span><span style="color: #000000;"> b2.y;<br />    </span><span style="color: #0000ff;">double</span><span style="color: #000000;"> x </span><span style="color: #000000;">=</span><span style="color: #000000;">(y3</span><span style="color: #000000;">-</span><span style="color: #000000;">y1</span><span style="color: #000000;">+</span><span style="color: #000000;">x1</span><span style="color: #000000;">*</span><span style="color: #000000;">(y2</span><span style="color: #000000;">-</span><span style="color: #000000;">y1)</span><span style="color: #000000;">/</span><span style="color: #000000;">(x2</span><span style="color: #000000;">-</span><span style="color: #000000;">x1)</span><span style="color: #000000;">-</span><span style="color: #000000;">x3</span><span style="color: #000000;">*</span><span style="color: #000000;">(y4</span><span style="color: #000000;">-</span><span style="color: #000000;">y3)</span><span style="color: #000000;">/</span><span style="color: #000000;">(x4</span><span style="color: #000000;">-</span><span style="color: #000000;">x3))</span><span style="color: #000000;">/</span><span style="color: #000000;">((y2</span><span style="color: #000000;">-</span><span style="color: #000000;">y1)</span><span style="color: #000000;">/</span><span style="color: #000000;">(x2</span><span style="color: #000000;">-</span><span style="color: #000000;">x1)</span><span style="color: #000000;">-</span><span style="color: #000000;">(y4</span><span style="color: #000000;">-</span><span style="color: #000000;">y3)</span><span style="color: #000000;">/</span><span style="color: #000000;">(x4</span><span style="color: #000000;">-</span><span style="color: #000000;">x3));<br />    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> x;<br />}<br /><br /></span><span style="color: #0000ff;">void</span><span style="color: #000000;"> work(Point a, Point b)<br />{<br />    b.y </span><span style="color: #000000;">-=</span><span style="color: #800080;">1</span><span style="color: #000000;">;<br />    </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">; i </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> n; i</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />    {<br />        Point p, q1, q2;<br />        p.x </span><span style="color: #000000;">=</span><span style="color: #000000;"> point[i].x;<br />        p.y </span><span style="color: #000000;">=</span><span style="color: #000000;"> a.y </span><span style="color: #000000;">-</span><span style="color: #000000;"> (b.y </span><span style="color: #000000;">-</span><span style="color: #000000;"> a.y) </span><span style="color: #000000;">/</span><span style="color: #000000;"> (b.x </span><span style="color: #000000;">-</span><span style="color: #000000;"> a.x) </span><span style="color: #000000;">*</span><span style="color: #000000;"> (a.x </span><span style="color: #000000;">-</span><span style="color: #000000;"> p.x);<br />        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> ((p.y </span><span style="color: #000000;">+</span><span style="color: #000000;"> eps </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> point[i].y </span><span style="color: #000000;">&amp;&amp;</span><span style="color: #000000;"> p.y </span><span style="color: #000000;">-</span><span style="color: #000000;"> eps </span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> point[i].y </span><span style="color: #000000;">-</span><span style="color: #800080;">1</span><span style="color: #000000;">) </span><span style="color: #000000;">||</span><span style="color: #000000;"> abs(p.y<br />                </span><span style="color: #000000;">-</span><span style="color: #000000;"> point[i].y) </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> eps </span><span style="color: #000000;">||</span><span style="color: #000000;"> abs(p.y </span><span style="color: #000000;">-</span><span style="color: #000000;"> point[i].y </span><span style="color: #000000;">+</span><span style="color: #800080;">1</span><span style="color: #000000;">) </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> eps)<br />            </span><span style="color: #0000ff;">continue</span><span style="color: #000000;">;<br />        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (i </span><span style="color: #000000;">==</span><span style="color: #800080;">0</span><span style="color: #000000;">)<br />            </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;<br />        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (p.y </span><span style="color: #000000;">-</span><span style="color: #000000;"> eps </span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> point[i].y)<br />            ans </span><span style="color: #000000;">=</span><span style="color: #000000;"> max(ans, intersect(a, b, point[i </span><span style="color: #000000;">-</span><span style="color: #800080;">1</span><span style="color: #000000;">], point[i]));<br />        </span><span style="color: #0000ff;">else</span><span style="color: #000000;"><br />        {<br />            q1 </span><span style="color: #000000;">=</span><span style="color: #000000;"> point[i </span><span style="color: #000000;">-</span><span style="color: #800080;">1</span><span style="color: #000000;">];<br />            q1.y </span><span style="color: #000000;">-=</span><span style="color: #800080;">1</span><span style="color: #000000;">;<br />            q2 </span><span style="color: #000000;">=</span><span style="color: #000000;"> point[i];<br />            q2.y </span><span style="color: #000000;">-=</span><span style="color: #800080;">1</span><span style="color: #000000;">;<br />            ans </span><span style="color: #000000;">=</span><span style="color: #000000;"> max(ans, intersect(a, b, q1, q2));<br />        }<br />        </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;<br />    }<br />    ok </span><span style="color: #000000;">=</span><span style="color: #0000ff;">true</span><span style="color: #000000;">;<br />}<br /><br /></span><span style="color: #0000ff;">int</span><span style="color: #000000;"> main()<br />{<br />    </span><span style="color: #008000;">//</span><span style="color: #008000;">freopen("t.txt", "r", stdin);</span><span style="color: #008000;"><br /></span><span style="color: #0000ff;">while</span><span style="color: #000000;"> (scanf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%d</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">n), n)<br />    {<br />        input();<br />        ans </span><span style="color: #000000;">=</span><span style="color: #000000;"> point[</span><span style="color: #800080;">0</span><span style="color: #000000;">].x;<br />        ok </span><span style="color: #000000;">=</span><span style="color: #0000ff;">false</span><span style="color: #000000;">;<br />        </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">; i </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> n; i</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />            </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> j </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">; j </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> n; j</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />                </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (i </span><span style="color: #000000;">!=</span><span style="color: #000000;"> j </span><span style="color: #000000;">&amp;&amp;</span><span style="color: #000000;">!</span><span style="color: #000000;">ok)<br />                    work(point[i], point[j]);<br />        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (ok)<br />            printf(</span><span style="color: #800000;">"</span><span style="color: #800000;">Through all the pipe.\n</span><span style="color: #800000;">"</span><span style="color: #000000;">);<br />        </span><span style="color: #0000ff;">else</span><span style="color: #000000;"><br />            printf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%.2f\n</span><span style="color: #800000;">"</span><span style="color: #000000;">, ans);<br />    }<br />    </span><span style="color: #0000ff;">return</span><span style="color: #800080;">0</span><span style="color: #000000;">;<br />}</span></div>


</div>


</div>
