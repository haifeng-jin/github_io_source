---
layout: post
title: poj3921
category: chinese
---
<p>迭代加深搜索</p>
<p>题意：一个有向图，每条边长度为1，问要让起点到终点距离大于K，至少要删除几个点。</p>
<p>思路：深搜，深搜过程中每次先宽搜求最短路，若最短路大于K，则已达到条件。否则最短路上必然要有点被删掉，就依次枚举删除每个点的情况并向下深搜。用迭代加深来提速，每次限定dfs搜索的深度。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('982c3876-0b98-411a-8b19-1b9ebe01d603')"><img id="code_img_closed_982c3876-0b98-411a-8b19-1b9ebe01d603" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_982c3876-0b98-411a-8b19-1b9ebe01d603" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('982c3876-0b98-411a-8b19-1b9ebe01d603',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" /><span class="cnblogs_code_collapse">View Code </span>
<div id="cnblogs_code_open_982c3876-0b98-411a-8b19-1b9ebe01d603" class="cnblogs_code_hide">
<pre>#include &lt;iostream&gt;<span style="color: #000000;">
#include </span>&lt;cstdio&gt;<span style="color: #000000;">
#include </span>&lt;cstdlib&gt;<span style="color: #000000;">
#include </span>&lt;cstring&gt;
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span><span style="color: #000000;"> std;

</span><span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> maxn = <span style="color: #800080;">60</span>, maxm = <span style="color: #800080;">4005</span>, inf = <span style="color: #800080;">0x3f3f3f3f</span><span style="color: #000000;">;

</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> edge[maxm], head[maxn], next[maxm];
</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> ncount;
</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> n, m, minlen;
</span><span style="color: #0000ff;">bool</span><span style="color: #000000;"> destroyed[maxn];

</span><span style="color: #0000ff;">void</span> addedge(<span style="color: #0000ff;">int</span> a, <span style="color: #0000ff;">int</span><span style="color: #000000;"> b)
{
    edge[ncount] </span>=<span style="color: #000000;"> b;
    next[ncount] </span>=<span style="color: #000000;"> head[a];
    head[a] </span>= ncount++<span style="color: #000000;">;
}

</span><span style="color: #0000ff;">void</span><span style="color: #000000;"> input()
{
    </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt; m; i++<span style="color: #000000;">)
    {
        </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> a, b;
        scanf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%d%d</span><span style="color: #800000;">"</span>, &amp;a, &amp;<span style="color: #000000;">b);
        a</span>--<span style="color: #000000;">;
        b</span>--<span style="color: #000000;">;
        addedge(a, b);
    }
}

</span><span style="color: #0000ff;">bool</span> bfs(<span style="color: #0000ff;">int</span> station[], <span style="color: #0000ff;">int</span> &amp;<span style="color: #000000;">num)
{
    </span><span style="color: #0000ff;">int</span> q[maxn], front = <span style="color: #800080;">0</span>, rear = <span style="color: #800080;">0</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> dist[maxn], pre[maxn];
    </span><span style="color: #0000ff;">bool</span><span style="color: #000000;"> vis[maxn];

    memset(vis, </span><span style="color: #800080;">0</span>, <span style="color: #0000ff;">sizeof</span><span style="color: #000000;">(vis));
    </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt; n; i++<span style="color: #000000;">)
        dist[i] </span>=<span style="color: #000000;"> inf;
    q[rear</span>++] = <span style="color: #800080;">0</span><span style="color: #000000;">;
    dist[</span><span style="color: #800080;">0</span>] = <span style="color: #800080;">0</span><span style="color: #000000;">;
    vis[</span><span style="color: #800080;">0</span>] = <span style="color: #0000ff;">true</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">while</span> (front !=<span style="color: #000000;"> rear)
    {
        </span><span style="color: #0000ff;">int</span> a = q[front++<span style="color: #000000;">];
        </span><span style="color: #0000ff;">int</span> temp =<span style="color: #000000;"> head[a];
        </span><span style="color: #0000ff;">while</span> (temp != -<span style="color: #800080;">1</span><span style="color: #000000;">)
        {
            </span><span style="color: #0000ff;">int</span> b =<span style="color: #000000;"> edge[temp];
            </span><span style="color: #0000ff;">if</span> (!destroyed[b] &amp;&amp; !<span style="color: #000000;">vis[b])
            {
                dist[b] </span>= dist[a] + <span style="color: #800080;">1</span><span style="color: #000000;">;
                pre[b] </span>=<span style="color: #000000;"> a;
                q[rear</span>++] =<span style="color: #000000;"> b;
                vis[b] </span>= <span style="color: #0000ff;">true</span><span style="color: #000000;">;
</span><span style="color: #008000;">//</span><span style="color: #008000;">                printf("%d %d\n", b, dist[b]);</span>
<span style="color: #000000;">            }
            temp </span>=<span style="color: #000000;"> next[temp];
        }
    }
    </span><span style="color: #0000ff;">if</span> (dist[n - <span style="color: #800080;">1</span>] &gt;<span style="color: #000000;"> minlen)
        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">int</span> temp = n - <span style="color: #800080;">1</span><span style="color: #000000;">;
    num </span>= <span style="color: #800080;">0</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">while</span> (pre[temp] != <span style="color: #800080;">0</span><span style="color: #000000;">)
    {
        station[num</span>++] =<span style="color: #000000;"> pre[temp];
        temp </span>=<span style="color: #000000;"> pre[temp];
    }
    </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
}

</span><span style="color: #0000ff;">bool</span> dfs(<span style="color: #0000ff;">int</span> step, <span style="color: #0000ff;">int</span><span style="color: #000000;"> bottom)
{
    </span><span style="color: #0000ff;">if</span> (step &gt;<span style="color: #000000;"> bottom)
        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;

    </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> station[maxn], num;

    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (bfs(station, num))
        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
    </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt; num; i++<span style="color: #000000;">)
    {
        destroyed[station[i]] </span>= <span style="color: #0000ff;">true</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">if</span> (dfs(step + <span style="color: #800080;">1</span><span style="color: #000000;">, bottom))
            </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
        destroyed[station[i]] </span>= <span style="color: #0000ff;">false</span><span style="color: #000000;">;
    }
    </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
}

</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> main()
{
</span><span style="color: #008000;">//</span><span style="color: #008000;">    freopen("t.txt", "r", stdin);</span>
    <span style="color: #0000ff;">while</span> (~scanf(<span style="color: #800000;">"</span><span style="color: #800000;">%d%d%d</span><span style="color: #800000;">"</span>, &amp;n, &amp;m, &amp;minlen) &amp;&amp; (n | m |<span style="color: #000000;"> minlen))
    {
        memset(head, </span>-<span style="color: #800080;">1</span>, <span style="color: #0000ff;">sizeof</span><span style="color: #000000;">(head));
        ncount </span>= <span style="color: #800080;">0</span><span style="color: #000000;">;
        input();
        </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt;= n - <span style="color: #800080;">2</span>; i++<span style="color: #000000;">)
        {
            memset(destroyed, </span><span style="color: #800080;">0</span>, <span style="color: #0000ff;">sizeof</span><span style="color: #000000;">(destroyed));
            </span><span style="color: #0000ff;">if</span> (dfs(<span style="color: #800080;">0</span><span style="color: #000000;">, i))
            {
                printf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%d\n</span><span style="color: #800000;">"</span><span style="color: #000000;">, i);
                </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
            }
        }
    }
    </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">0</span><span style="color: #000000;">;
}</span></pre>
</div>
</div>
