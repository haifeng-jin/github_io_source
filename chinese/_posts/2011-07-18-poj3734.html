---
layout: post
title: poj3734
category: chinese
---
<p>题意：给n个block涂4种颜色，要求其中red和green的block为偶数，其余随意。问有多少种涂法。</p>
<p>分析：这题我们可以先认为是一道dp题，设f[maxn][4]，f[i][j]表示有i个block时，green和red的奇偶性为状态j时（及把j化为二进制第一位表示green是否为奇数，第二位对应red）。则我们可以由f[i - 1]推出f[i]。递推的过程是将f[i-1]的各位进行一些加法运算并附给f[i]的对应位。这个过程我们可以用矩阵来解决。f[i-1]是一个1＊4的矩阵，乘以一个4*4的矩阵之后得到一个1*4的矩阵即为f[i]。线代的知识这里就不说了。本题f[0]={1,0,0,0}； 4*4矩阵＝{ {2,1,1,0},{1,2,0,1},{1,0,2,1},{0,1,1,2} };</p>
<p>化为矩阵后有个好处就是可以用快速幂把n次运算改为logn次运算。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('99f45e79-4cb2-439f-86ed-f4d1191f8ddf')"><img id="code_img_closed_99f45e79-4cb2-439f-86ed-f4d1191f8ddf" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_99f45e79-4cb2-439f-86ed-f4d1191f8ddf" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('99f45e79-4cb2-439f-86ed-f4d1191f8ddf',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" /><span class="cnblogs_code_collapse">View Code </span>
<div id="cnblogs_code_open_99f45e79-4cb2-439f-86ed-f4d1191f8ddf" class="cnblogs_code_hide">
<pre><span style="color: #000000;">#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">iostream</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br />#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">cstdio</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br />#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">cstdlib</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br />#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">cstring</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br /></span><span style="color: #0000ff;">using</span><span style="color: #0000ff;">namespace</span><span style="color: #000000;"> std;<br /><br /></span><span style="color: #0000ff;">#define</span><span style="color: #000000;"> maxn 4</span><span style="color: #000000;"><br /></span><span style="color: #0000ff;">#define</span><span style="color: #000000;"> w 10007</span><span style="color: #000000;"><br /><br /></span><span style="color: #0000ff;">struct</span><span style="color: #000000;"> Matrix<br />{<br />    </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> a[maxn][maxn];<br />    </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> x, y;<br />}ans, f;<br /><br /></span><span style="color: #0000ff;">int</span><span style="color: #000000;"> n;<br /></span><span style="color: #0000ff;">int</span><span style="color: #000000;"> matrix[maxn][maxn]</span><span style="color: #000000;">=</span><span style="color: #000000;">{ {</span><span style="color: #800080;">2</span><span style="color: #000000;">,</span><span style="color: #800080;">1</span><span style="color: #000000;">,</span><span style="color: #800080;">1</span><span style="color: #000000;">,</span><span style="color: #800080;">0</span><span style="color: #000000;">},{</span><span style="color: #800080;">1</span><span style="color: #000000;">,</span><span style="color: #800080;">2</span><span style="color: #000000;">,</span><span style="color: #800080;">0</span><span style="color: #000000;">,</span><span style="color: #800080;">1</span><span style="color: #000000;">},{</span><span style="color: #800080;">1</span><span style="color: #000000;">,</span><span style="color: #800080;">0</span><span style="color: #000000;">,</span><span style="color: #800080;">2</span><span style="color: #000000;">,</span><span style="color: #800080;">1</span><span style="color: #000000;">},{</span><span style="color: #800080;">0</span><span style="color: #000000;">,</span><span style="color: #800080;">1</span><span style="color: #000000;">,</span><span style="color: #800080;">1</span><span style="color: #000000;">,</span><span style="color: #800080;">2</span><span style="color: #000000;">} };<br /><br />Matrix mul(Matrix </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">a, </span><span style="color: #0000ff;">const</span><span style="color: #000000;"> Matrix </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">b)<br />{<br />    Matrix ret;<br />    </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">; i </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> a.x; i</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />        </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> j </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">; j </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> b.y; j</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />        {<br />            </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> d </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">;<br />            </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> k </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">; k </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> a.y; k</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />                d </span><span style="color: #000000;">=</span><span style="color: #000000;"> (d </span><span style="color: #000000;">+</span><span style="color: #000000;"> a.a[i][k] </span><span style="color: #000000;">*</span><span style="color: #000000;"> b.a[k][j] </span><span style="color: #000000;">%</span><span style="color: #000000;"> w) </span><span style="color: #000000;">%</span><span style="color: #000000;"> w;<br />            ret.a[i][j] </span><span style="color: #000000;">=</span><span style="color: #000000;"> d;<br />        }<br />    ret.x </span><span style="color: #000000;">=</span><span style="color: #000000;"> a.x;<br />    ret.y </span><span style="color: #000000;">=</span><span style="color: #000000;"> b.y;<br />    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> ret;<br />}<br /><br />Matrix power(Matrix m, </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> n)<br />{<br />    Matrix ret;<br />    memset(ret.a, </span><span style="color: #800080;">0</span><span style="color: #000000;">, </span><span style="color: #0000ff;">sizeof</span><span style="color: #000000;">(ret.a));<br />    </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">; i </span><span style="color: #000000;">&lt;</span><span style="color: #800080;">4</span><span style="color: #000000;">; i</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />        ret.a[i][i] </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">;<br />    ret.x </span><span style="color: #000000;">=</span><span style="color: #000000;"> ret.y </span><span style="color: #000000;">=</span><span style="color: #800080;">4</span><span style="color: #000000;">;<br />    </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> k </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">; k </span><span style="color: #000000;">&lt;=</span><span style="color: #000000;"> n; k </span><span style="color: #000000;">&lt;&lt;=</span><span style="color: #800080;">1</span><span style="color: #000000;">)<br />    {<br />        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (k </span><span style="color: #000000;">&amp;</span><span style="color: #000000;"> n)<br />            ret </span><span style="color: #000000;">=</span><span style="color: #000000;"> mul(ret, m);<br />        m </span><span style="color: #000000;">=</span><span style="color: #000000;"> mul(m, m);<br />    }<br />    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> ret;<br />}<br /><br /></span><span style="color: #0000ff;">int</span><span style="color: #000000;"> main()<br />{<br />#ifndef ONLINE_JUDGE<br />    freopen(</span><span style="color: #800000;">"</span><span style="color: #800000;">t.txt</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #800000;">"</span><span style="color: #800000;">r</span><span style="color: #800000;">"</span><span style="color: #000000;">, stdin);<br /></span><span style="color: #0000ff;">#endif</span><span style="color: #000000;"><br />    f.x </span><span style="color: #000000;">=</span><span style="color: #000000;"> f.y </span><span style="color: #000000;">=</span><span style="color: #800080;">4</span><span style="color: #000000;">;<br />    </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">; i </span><span style="color: #000000;">&lt;</span><span style="color: #800080;">4</span><span style="color: #000000;">; i</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />        </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> j </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">; j </span><span style="color: #000000;">&lt;</span><span style="color: #800080;">4</span><span style="color: #000000;">; j</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />            f.a[i][j] </span><span style="color: #000000;">=</span><span style="color: #000000;"> matrix[i][j];<br />    </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> t;<br />    scanf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%d</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">t);<br />    </span><span style="color: #0000ff;">while</span><span style="color: #000000;"> (t</span><span style="color: #000000;">--</span><span style="color: #000000;">)<br />    {<br />        scanf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%d</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">n);<br />        f.x </span><span style="color: #000000;">=</span><span style="color: #000000;"> f.y </span><span style="color: #000000;">=</span><span style="color: #800080;">4</span><span style="color: #000000;">;<br />        memset(ans.a, </span><span style="color: #800080;">0</span><span style="color: #000000;">, </span><span style="color: #0000ff;">sizeof</span><span style="color: #000000;">(ans.a));<br />        ans.a[</span><span style="color: #800080;">0</span><span style="color: #000000;">][</span><span style="color: #800080;">0</span><span style="color: #000000;">] </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">;<br />        ans.x </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">;<br />        ans.y </span><span style="color: #000000;">=</span><span style="color: #800080;">4</span><span style="color: #000000;">;<br />        ans </span><span style="color: #000000;">=</span><span style="color: #000000;"> mul(ans, power(f, n));<br />        printf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%d\n</span><span style="color: #800000;">"</span><span style="color: #000000;">, ans.a[</span><span style="color: #800080;">0</span><span style="color: #000000;">][</span><span style="color: #800080;">0</span><span style="color: #000000;">]);<br />    }<br />    </span><span style="color: #0000ff;">return</span><span style="color: #800080;">0</span><span style="color: #000000;">;<br />}</span></pre>
</div>
</div>
