---
layout: post
title: poj1408
category: chinese
---
<p>题意：给出一个正方形，每条边上有n个点，把这些点作为端点拉线组成的网格（整个正方形由一些四边行拼成），求最大格的面积。</p>
<p>分析：计算几何，求出所有线的交点，分别计算每个格的面积。</p>
<p>在求线段交点时可以用叉积面积的方式，求ac,bd交点：</p>
<p>void intersection(Point &amp;a, Point &amp;b, Point &amp;c, Point &amp;d, Point &amp;ret)<br />{<br />&nbsp;&nbsp;&nbsp; double s1 = xmulti(a, c, b);<br />&nbsp;&nbsp;&nbsp; double s2 = xmulti(a, c, d);<br />&nbsp;&nbsp;&nbsp; ret.x = (s1 * d.x - s2 * b.x) / (s1 - s2);<br />&nbsp;&nbsp;&nbsp; ret.y = (s1 * d.y - s2 * b.y) / (s1 - s2);<br />}</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('f3403305-5b95-4e26-a8be-ffd80349dd14')"><img id="code_img_closed_f3403305-5b95-4e26-a8be-ffd80349dd14" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_f3403305-5b95-4e26-a8be-ffd80349dd14" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('f3403305-5b95-4e26-a8be-ffd80349dd14',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" /><span class="cnblogs_code_collapse">View Code </span>
<div id="cnblogs_code_open_f3403305-5b95-4e26-a8be-ffd80349dd14" class="cnblogs_code_hide">
<div><span style="color: #000000;">#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">iostream</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br />#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">cstdio</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br />#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">cstdlib</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br />#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">cstring</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br />#include </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">cmath</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"><br /></span><span style="color: #0000ff;">using</span><span style="color: #0000ff;">namespace</span><span style="color: #000000;"> std;<br /><br /></span><span style="color: #0000ff;">#define</span><span style="color: #000000;"> maxn 50</span><span style="color: #000000;"><br /><br /></span><span style="color: #0000ff;">struct</span><span style="color: #000000;"> Point<br />{<br />    </span><span style="color: #0000ff;">double</span><span style="color: #000000;"> x, y;<br />} point[maxn][maxn];<br /><br /></span><span style="color: #0000ff;">double</span><span style="color: #000000;"> ans;<br /></span><span style="color: #0000ff;">int</span><span style="color: #000000;"> n;<br /><br /></span><span style="color: #0000ff;">void</span><span style="color: #000000;"> input()<br />{<br />    n</span><span style="color: #000000;">++</span><span style="color: #000000;">;<br />    point[</span><span style="color: #800080;">0</span><span style="color: #000000;">][</span><span style="color: #800080;">0</span><span style="color: #000000;">].x </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">;<br />    point[</span><span style="color: #800080;">0</span><span style="color: #000000;">][</span><span style="color: #800080;">0</span><span style="color: #000000;">].y </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">;<br />    point[</span><span style="color: #800080;">0</span><span style="color: #000000;">][n].x </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">;<br />    point[</span><span style="color: #800080;">0</span><span style="color: #000000;">][n].y </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">;<br />    point[n][</span><span style="color: #800080;">0</span><span style="color: #000000;">].x </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">;<br />    point[n][</span><span style="color: #800080;">0</span><span style="color: #000000;">].y </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">;<br />    point[n][n].x </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">;<br />    point[n][n].y </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">;<br />    </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">; i </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> n; i</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />    {<br />        scanf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%lf</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">point[</span><span style="color: #800080;">0</span><span style="color: #000000;">][i].x);<br />        point[</span><span style="color: #800080;">0</span><span style="color: #000000;">][i].y </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">;<br />    }<br />    </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">; i </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> n; i</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />    {<br />        scanf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%lf</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">point[n][i].x);<br />        point[n][i].y </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">;<br />    }<br />    </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">; i </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> n; i</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />    {<br />        scanf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%lf</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">point[i][</span><span style="color: #800080;">0</span><span style="color: #000000;">].y);<br />        point[i][</span><span style="color: #800080;">0</span><span style="color: #000000;">].x </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">;<br />    }<br />    </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">; i </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> n; i</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />    {<br />        scanf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%lf</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">point[i][n].y);<br />        point[i][n].x </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">;<br />    }<br />}<br /><br /></span><span style="color: #0000ff;">double</span><span style="color: #000000;"> xmulti(Point </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">p0, Point </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">p1, Point </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">p2)<br />{<br />    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> ((p1.x </span><span style="color: #000000;">-</span><span style="color: #000000;"> p0.x) </span><span style="color: #000000;">*</span><span style="color: #000000;"> (p2.y </span><span style="color: #000000;">-</span><span style="color: #000000;"> p0.y) </span><span style="color: #000000;">-</span><span style="color: #000000;"> (p2.x </span><span style="color: #000000;">-</span><span style="color: #000000;"> p0.x) </span><span style="color: #000000;">*</span><span style="color: #000000;"> (p1.y </span><span style="color: #000000;">-</span><span style="color: #000000;"> p0.y));<br />}<br /><br /></span><span style="color: #0000ff;">void</span><span style="color: #000000;"> intersection(Point </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">a, Point </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">b, Point </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">c, Point </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">d, Point </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">ret)<br />{<br />    </span><span style="color: #0000ff;">double</span><span style="color: #000000;"> s1 </span><span style="color: #000000;">=</span><span style="color: #000000;"> xmulti(a, c, b);<br />    </span><span style="color: #0000ff;">double</span><span style="color: #000000;"> s2 </span><span style="color: #000000;">=</span><span style="color: #000000;"> xmulti(a, c, d);<br />    ret.x </span><span style="color: #000000;">=</span><span style="color: #000000;"> (s1 </span><span style="color: #000000;">*</span><span style="color: #000000;"> d.x </span><span style="color: #000000;">-</span><span style="color: #000000;"> s2 </span><span style="color: #000000;">*</span><span style="color: #000000;"> b.x) </span><span style="color: #000000;">/</span><span style="color: #000000;"> (s1 </span><span style="color: #000000;">-</span><span style="color: #000000;"> s2);<br />    ret.y </span><span style="color: #000000;">=</span><span style="color: #000000;"> (s1 </span><span style="color: #000000;">*</span><span style="color: #000000;"> d.y </span><span style="color: #000000;">-</span><span style="color: #000000;"> s2 </span><span style="color: #000000;">*</span><span style="color: #000000;"> b.y) </span><span style="color: #000000;">/</span><span style="color: #000000;"> (s1 </span><span style="color: #000000;">-</span><span style="color: #000000;"> s2);<br />}<br /><br /></span><span style="color: #0000ff;">double</span><span style="color: #000000;"> area(Point </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">a, Point </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">b, Point </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">c, Point </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">d)<br />{<br />    </span><span style="color: #0000ff;">double</span><span style="color: #000000;"> s1 </span><span style="color: #000000;">=</span><span style="color: #000000;"> xmulti(a, c, b);<br />    </span><span style="color: #0000ff;">double</span><span style="color: #000000;"> s2 </span><span style="color: #000000;">=</span><span style="color: #000000;"> xmulti(a, c, d);<br />    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> (abs(s1) </span><span style="color: #000000;">+</span><span style="color: #000000;"> abs(s2)) </span><span style="color: #000000;">/</span><span style="color: #800080;">2</span><span style="color: #000000;">;<br />}<br /><br /></span><span style="color: #0000ff;">void</span><span style="color: #000000;"> work()<br />{<br />    </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">; i </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> n; i</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />        </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> j </span><span style="color: #000000;">=</span><span style="color: #800080;">1</span><span style="color: #000000;">; j </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> n; j</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />            intersection(point[i][</span><span style="color: #800080;">0</span><span style="color: #000000;">], point[</span><span style="color: #800080;">0</span><span style="color: #000000;">][j], point[i][n], point[n][j], point[i][j]);<br />    ans </span><span style="color: #000000;">=</span><span style="color: #000000;">-</span><span style="color: #800080;">1</span><span style="color: #000000;">;<br />    </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> i </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">; i </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> n; i</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />        </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (</span><span style="color: #0000ff;">int</span><span style="color: #000000;"> j </span><span style="color: #000000;">=</span><span style="color: #800080;">0</span><span style="color: #000000;">; j </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> n; j</span><span style="color: #000000;">++</span><span style="color: #000000;">)<br />        {<br />            </span><span style="color: #0000ff;">double</span><span style="color: #000000;"> temp </span><span style="color: #000000;">=</span><span style="color: #000000;"> area(point[i][j], point[i </span><span style="color: #000000;">+</span><span style="color: #800080;">1</span><span style="color: #000000;">][j], point[i </span><span style="color: #000000;">+</span><span style="color: #800080;">1</span><span style="color: #000000;">][j </span><span style="color: #000000;">+</span><span style="color: #800080;">1</span><span style="color: #000000;">], point[i][j </span><span style="color: #000000;">+</span><span style="color: #800080;">1</span><span style="color: #000000;">]);<br />            ans </span><span style="color: #000000;">=</span><span style="color: #000000;"> max(ans, temp);<br />        }<br />}<br /><br /></span><span style="color: #0000ff;">int</span><span style="color: #000000;"> main()<br />{<br />    </span><span style="color: #008000;">//</span><span style="color: #008000;">freopen("t.txt", "r", stdin);</span><span style="color: #008000;"><br /></span><span style="color: #0000ff;">while</span><span style="color: #000000;"> (scanf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%d</span><span style="color: #800000;">"</span><span style="color: #000000;">, </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">n), n)<br />    {<br />        input();<br />        work();<br />        printf(</span><span style="color: #800000;">"</span><span style="color: #800000;">%.6f\n</span><span style="color: #800000;">"</span><span style="color: #000000;">, ans);<br />    }<br />    </span><span style="color: #0000ff;">return</span><span style="color: #800080;">0</span><span style="color: #000000;">;<br />}</span></div>
</div>
</div>
